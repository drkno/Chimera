<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Door Control</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <base href="/">
    </head>
    <body>
        <script>
        let sendRequest = (apiCall, callback) => {
            let xhttp = new XMLHttpRequest();
            if (callback) {
                xhttp.addEventListener("load", callback);
            }
            xhttp.open("GET", "/api/" + apiCall, true);
            xhttp.send();
        };

        let openDoor = () => {
            sendRequest('open');
        };

        let closeDoor = () => {
            sendRequest('close');
        };

        let statusUpdate = () => {
            setTimeout(statusUpdate, 2500);
            sendRequest('status', function() {
                let data = JSON.parse(this.responseText),
                    state = data.state;
                document.getElementById('status').innerHTML = state;
            });
        };

        statusUpdate();
        </script>

        <p>
            Door Status: <span id="status">Unknown</span>
        </p>
        <p>
            <input type="button" value="Open Door" onclick="openDoor()" />
        </p>
        <p>
            <input type="button" value="Close Door" onclick="closeDoor()" />
        </p>
    </body>
</html>
